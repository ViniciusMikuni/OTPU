# Optimal transport for a global event description at high-intensity hadron colliders

Official repository of the paper [Optimal transport for a global event description at high-intensity hadron colliders](https://arxiv.org/abs/2211.02029)

# Dependencies

Tensorflow 2.6
Horovod (Can be ignored for inference by commenting the import statements)
fastjet
uproot3

# Preprocessing of root files

Files are first preprocessed from root to h5 files before used as inputs to the network. You can modify the path for the input files before running:

```
python utils.py --sample ZJets --base_path path/to/inputs --out_path path/to/outputs
```

# Clustering and plotting

To produce files containing the jet information you can run:

```
python cluster_results.py --nevts 30000 --dataset ZJets_raw.h5 --model [SWDPU_NSWD4_EMD/SWDPU_NSWD4_EMD_met]
```

Plots are made using the files generated by the last step using:

```
python plot.py --dataset ZJets_raw.h5 --model [SWDPU_NSWD4_EMD/SWDPU_NSWD4_EMD_met]
```